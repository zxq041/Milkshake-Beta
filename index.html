<!-- index.html (STRONA G≈Å√ìWNA) ‚Äî NAPRAWIONA WERSJA Z LOJALNO≈öCIƒÑ PWA -->
<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>MilkShake Bar S≈Çupsk | Milkshake, desery i burgery</title>

  <meta name="description" content="MilkShake Bar w S≈Çupsku ‚Äì kremowe milkshake‚Äôi, desery, burgery i ≈õniadania. Zarezerwuj stolik online i odkryj swoje ulubione smaki.">
  <meta name="keywords" content="milkshake s≈Çupsk, milkshake bar s≈Çupsk, desery s≈Çupsk, burgery s≈Çupsk, koktajle mleczne s≈Çupsk">
  <meta name="robots" content="index, follow">
  <link rel="icon" type="image/png" href="/favicon.png" sizes="48x48">
  <link rel="icon" type="image/png" href="/favicon.png" sizes="96x96">
  <link rel="apple-touch-icon" href="/favicon.png" sizes="180x180">
  <link rel="shortcut icon" href="/favicon.png" type="image/png">

  <link rel="canonical" href="https://www.milkshakebar.pl/">

  <meta property="og:title" content="MilkShake Bar S≈Çupsk | Milkshake, desery i burgery">
  <meta property="og:description" content="Nowoczesny MilkShake Bar w S≈Çupsku ‚Äì milkshake‚Äôi, desery, burgery i ≈õniadania. Zarezerwuj stolik online.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://www.milkshakebar.pl/">
  <meta property="og:image" content="https://i.imgur.com/XIdoN0y.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="MilkShake Bar S≈Çupsk | Milkshake, desery i burgery">
  <meta name="twitter:description" content="Kremowe milkshake‚Äôi, desery i burgery w S≈Çupsku. Sprawd≈∫ nasze menu i zarezerwuj stolik online.">
  <meta name="twitter:image" content="https://i.imgur.com/XIdoN0y.png">

  <!-- PWA -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#FF6A00">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;900&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

  <style>
    :root {
      --primary-color: #FF6A00;
      --secondary-color: #FF9100;
      --accent-color: #FFE0B2;
      --background-light: #FFF6EC;
      --background-dark: #22110A;
      --text-color-dark: #2B1300;
      --text-color-light: #FFFFFF;
      --gradient-bg: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      --shadow: 0px 10px 30px rgba(0, 0, 0, 0.12);
      --border-radius: 20px;
      --success-color: #16A34A;
      --error-color: #DC2626;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; font-size: 16px; }
    body {
      font-family: 'Poppins', sans-serif;
      color: var(--text-color-dark);
      background-color: var(--background-light);
      overflow-x: hidden;
      transition: background-color 0.3s ease;
    }
    .container { max-width: 1280px; margin: 0 auto; padding: 0 25px; }
    h1, h2, h3 { font-weight: 700; }

    h2.section-title {
      font-size: clamp(2.5rem, 5vw, 4rem);
      font-weight: 900;
      margin-bottom: 50px;
      text-align: center;
      background: var(--gradient-bg);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      position: relative;
    }

    /* HAPPY BAR spacing */
    body.has-happybar .header { top: 36px; }
    body.has-happybar .hero { padding-top: 136px; }

    .header {
      position: fixed; top: 0; left: 0; width: 100%;
      padding: 20px 0; z-index: 1000; transition: all 0.3s ease-in-out;
    }
    .header.scrolled {
      background: rgba(255, 246, 236, 0.9);
      backdrop-filter: blur(10px);
      padding: 15px 0;
      box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    }
    .navbar { display: flex; justify-content: space-between; align-items: center; }
    .logo {
      display: flex; align-items: center; text-decoration: none;
      font-weight: 700; font-size: 1.5rem; color: var(--primary-color);
    }
    .logo img {
      width: 50px; height: 50px; border-radius: 50%;
      margin-right: 15px; transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .logo:hover img { transform: rotate(360deg) scale(1.1); }

    .nav-menu { list-style: none; display: flex; align-items: center; }
    .nav-item { margin: 0 20px; }
    .nav-link {
      color: var(--text-color-dark); text-decoration: none; font-weight: 600;
      position: relative; padding: 5px 0;
    }
    .nav-link::after {
      content: ''; position: absolute; bottom: -5px; left: 0;
      width: 100%; height: 3px; background: var(--gradient-bg);
      border-radius: 2px; transform: scaleX(0); transform-origin: right;
      transition: transform 0.4s cubic-bezier(0.19, 1, 0.22, 1);
    }
    .nav-link:hover::after, .nav-link.active::after {
      transform: scaleX(1); transform-origin: left;
    }

    .btn {
      padding: 14px 30px; border-radius: 50px; font-weight: 600;
      text-decoration: none; cursor: pointer; transition: all 0.3s ease;
      border: none; display: inline-flex; align-items: center; gap: 10px;
    }
    .btn-primary {
      background: var(--gradient-bg); color: white;
      box-shadow: 0 4px 20px rgba(255, 106, 0, 0.5);
    }
    .btn-primary:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(255, 106, 0, 0.7);
    }
    .hamburger { display: none; }

    .hero {
      min-height: 100vh; display: flex; align-items: center; padding-top: 100px;
      background-image: url('https://i.imgur.com/XdaLKqJ.png');
      background-size: cover; background-position: center; position: relative;
    }
    .hero::before {
      content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      background-color: rgba(255, 246, 236, 0.85); backdrop-filter: blur(10px);
    }
    .hero-content {
      position: relative; z-index: 1; display: flex; align-items: center;
      justify-content: space-between; gap: 40px;
    }
    .hero-text { max-width: 50%; }
    .hero h1 {
      font-size: clamp(3rem, 7vw, 5.5rem);
      line-height: 1.1; font-weight: 900; margin-bottom: 25px;
    }
    .hero .highlight {
      background: var(--gradient-bg);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .hero p {
      font-size: 1.2rem; margin-bottom: 40px; line-height: 1.7; max-width: 500px;
    }
    .hero-image-container { position: relative; width: 45%; }
    .hero-image {
      width: 100%; max-width: 500px; height: auto; border-radius: var(--border-radius);
      transform: rotate(3deg); box-shadow: var(--shadow);
    }

    .section { padding: 120px 0; position: relative; }
    #about { background-color: #fff; }
    .about-content {
      display: grid; grid-template-columns: 1fr 1fr; align-items: center; gap: 60px;
    }
    .about-image img { width: 100%; border-radius: var(--border-radius); box-shadow: var(--shadow); }
    .about-text h3 { font-size: 2.2rem; margin-bottom: 20px; }
    .about-text p { line-height: 1.8; margin-bottom: 20px; }

    .see-more-button-container { text-align: center; margin-top: 10px; }

    #gallery { background-color: #fff; }
    .gallery-grid { columns: 3 250px; column-gap: 1.5rem; }
    .gallery-item { margin-bottom: 1.5rem; break-inside: avoid; }
    .gallery-item img {
      width: 100%; height: auto; display: block; border-radius: var(--border-radius);
      box-shadow: var(--shadow); transition: filter 0.3s ease;
    }
    .gallery-item img:hover { filter: brightness(0.9); }

    .location-contact-grid {
      display: grid; grid-template-columns: 1fr 1.2fr; gap: 80px; align-items: center;
      background: var(--gradient-bg); color: var(--text-color-light);
      padding: 80px; border-radius: 30px;
    }
    .location-details h3 {
      font-size: 2.5rem; margin-bottom: 30px; color: var(--text-color-light);
    }
    .info-item {
      display: flex; align-items: flex-start; gap: 20px; margin-bottom: 25px;
    }
    .info-item i {
      font-size: 1.5rem; color: var(--text-color-light); margin-top: 5px;
    }
    .info-item span { font-size: 1.1rem; line-height: 1.6; }
    .map-container {
      width: 100%; height: 100%; min-height: 400px; border-radius: var(--border-radius);
      overflow: hidden; box-shadow: var(--shadow);
      position: relative;
    }
    .map-container iframe {
      width: 100%; height: 100%; border: 0;
      filter: grayscale(20%) sepia(30%) hue-rotate(-15deg) saturate(140%);
    }

    .footer { background-color: var(--background-dark); color: #ccc; padding: 80px 0 40px; }
    .footer-grid {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 40px; margin-bottom: 50px;
    }
    .footer-col h4 {
      font-size: 1.4rem; color: #fff; margin-bottom: 25px; position: relative;
    }
    .footer-col h4::after {
      content: ''; position: absolute; bottom: -10px; left: 0;
      width: 50px; height: 3px; background: var(--gradient-bg); border-radius: 2px;
    }
    .footer-col .logo { margin-bottom: 20px; }
    .footer-col p, .footer-col li { font-size: 0.95rem; line-height: 1.8; }
    .footer-col ul { list-style: none; }
    .footer-col li { margin-bottom: 10px; }
    .footer-col a {
      color: #ccc; text-decoration: none;
      transition: color 0.3s ease, padding-left 0.3s ease;
    }
    .footer-col a:hover { color: var(--text-color-light); padding-left: 5px; }
    .footer-socials { display: flex; gap: 15px; }
    .footer-socials a {
      width: 40px; height: 40px; display: flex; justify-content: center; align-items: center;
      background-color: rgba(255,255,255,0.1); color: #fff; border-radius: 50%;
      text-decoration: none; transition: background-color 0.3s ease, transform 0.3s ease;
    }
    .footer-socials a:hover {
      background-color: var(--primary-color); transform: translateY(-5px); padding-left: 0;
    }
    .footer-bottom {
      text-align: center; border-top: 1px solid rgba(255,255,255,0.1);
      padding-top: 30px; font-size: 0.9rem; opacity: 0.8;
    }

    .fade-in {
      opacity: 0; transform: translateY(50px);
      transition: opacity 0.8s ease, transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .fade-in.visible { opacity: 1; transform: translateY(0); }

    .reservation-toast {
      position: fixed; bottom: 20px; right: 20px; background: var(--success-color);
      color: #fff; padding: 12px 18px; border-radius: 999px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.25);
      font-size: 0.9rem; display: flex; align-items: center; gap: 8px;
      opacity: 0; pointer-events: none; transform: translateY(8px);
      transition: opacity 0.25s ease, transform 0.25s ease; z-index: 9999;
    }
    .reservation-toast.visible {
      opacity: 1; transform: translateY(0); pointer-events: auto;
    }
    .reservation-toast i { font-size: 1rem; }

    @media(max-width: 992px) {
      .nav-menu {
        position: fixed; top: 0; right: -100%; width: 70%; height: 100vh;
        background: white; box-shadow: -10px 0 30px rgba(0,0,0,0.1);
        flex-direction: column; justify-content: center; gap: 40px;
        transition: right 0.5s cubic-bezier(0.77, 0, 0.175, 1);
      }
      .nav-menu.active { right: 0; }
      .nav-link { font-size: 1.5rem; }
      .hamburger { display: block; z-index: 1001; cursor: pointer; }
      .btn-primary.nav-btn { display: none; }

      .hero-content { flex-direction: column; text-align: center; }
      .hero-text { max-width: 100%; }
      .hero-image-container { width: 80%; margin-top: 40px; }
      .about-content { grid-template-columns: 1fr; }
      .about-image { order: -1; }
    }
    @media(max-width: 768px) {
      .location-contact-grid {
        grid-template-columns: 1fr; padding: 40px;
      }
      .gallery-grid { columns: 2 200px; }
      .footer-grid { text-align: center; }
      .footer-col h4::after { left: 50%; transform: translateX(-50%); }
      .footer-socials { justify-content: center; }
    }

    .reservation-wrapper.grid-two-col {
      display: grid; grid-template-columns: 1fr 420px; gap: 32px; align-items: start;
      background-color: #fff; padding: 32px; border-radius: 20px; box-shadow: var(--shadow);
      max-width: 1100px; margin: 0 auto;
    }
    .form-container h3, .reservation-summary h3 {
      margin-bottom: 18px; font-size: 1.6rem;
    }
    .booking-form .form-row {
      display: flex; gap: 18px; margin-bottom: 14px;
    }
    .booking-form .form-group {
      flex: 1; display: flex; flex-direction: column;
    }
    .booking-form .form-group.fullwidth { flex: 1 1 100%; }
    .booking-form label {
      font-size: 0.95rem; margin-bottom: 8px; color: var(--text-color-dark); font-weight: 600;
    }
    .booking-form input[type="text"],
    .booking-form input[type="tel"],
    .booking-form input[type="date"],
    .booking-form input[type="time"],
    .booking-form select {
      width: 100%; padding: 12px 14px; border: 2px solid #e9e6e3; border-radius: 12px;
      font-family: 'Poppins', sans-serif; font-size: 1rem;
      transition: border-color 0.2s ease, box-shadow 0.15s ease;
    }
    .booking-form input:focus, .booking-form select:focus {
      outline: none; border-color: var(--primary-color);
      box-shadow: 0 6px 18px rgba(255,106,0,0.08);
    }
    .room-options { display: flex; gap: 12px; flex-wrap: wrap; }
    .room-label {
      display: inline-flex; align-items: center; gap: 8px; padding: 8px 12px;
      border-radius: 999px; background: rgba(0,0,0,0.03); font-size: 0.95rem;
    }
    .room-label input { transform: translateY(1px); }
    .booking-submit { width: 100%; padding: 14px 18px; border-radius: 12px; font-weight: 700; }
    .reservation-summary {
      background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.95));
      padding: 20px; border-radius: 14px; color: var(--text-color-dark);
    }
    .summary-card {
      background: #fff; padding: 14px; border-radius: 12px;
      box-shadow: 0 6px 20px rgba(0,0,0,0.06); margin-bottom: 16px;
    }
    .summary-card p { margin: 8px 0; font-size: 0.98rem; }
    .map-mini { margin-top: 6px; }

    @media (max-width: 992px) {
      .reservation-wrapper.grid-two-col {
        grid-template-columns: 1fr; padding: 22px;
      }
      .booking-form .form-row { flex-direction: column; }
    }

    /* MAP arrows */
    .map-arrow {
      position: absolute; top: 50%; transform: translateY(-50%);
      width: 44px; height: 44px; border: none; border-radius: 999px;
      cursor: pointer; z-index: 5; background: rgba(255,255,255,0.95);
      box-shadow: 0 6px 18px rgba(0,0,0,0.18);
      display: grid; place-items: center;
      transition: transform 0.2s ease, background 0.2s ease;
    }
    .map-arrow:hover { transform: translateY(-50%) scale(1.06); background: white; }
    .map-arrow.left { left: 12px; }
    .map-arrow.right { right: 12px; }

    .map-badge {
      position: absolute; bottom: 12px; left: 12px; z-index: 5;
      background: rgba(0,0,0,0.65); color: #fff; font-weight: 700; font-size: 0.9rem;
      padding: 6px 10px; border-radius: 999px; letter-spacing: 0.2px;
    }

    /* LOYALTY rewards */
    .reward-item {
      display:flex; justify-content:space-between; align-items:center;
      background:#fff; padding:10px 12px; border-radius:12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }
    .reward-item small { opacity:0.8; }
    .reward-item button { padding:8px 12px; border-radius:999px; font-weight:700; }
    .reward-item button:disabled { opacity:0.5; cursor:not-allowed; transform:none; box-shadow:none; }
  </style>
</head>
<body>

  <!-- HAPPY HOUR TOP BAR -->
  <div id="happyBar" style="
    position: fixed; top: 0; left: 0; right: 0; z-index: 2000;
    background: linear-gradient(90deg, #FF6A00, #FF9100);
    color: white; font-weight: 700; font-size: 0.95rem;
    padding: 8px 14px; text-align: center; display: none;
    box-shadow: 0 6px 16px rgba(0,0,0,0.12);
  ">
    <span id="happyBarText"></span>
  </div>

  <header class="header" id="header">
    <div class="container">
      <nav class="navbar">
        <a href="#home" class="logo">
          <img src="https://i.imgur.com/Twr2Rms.jpeg" alt="Logo MilkShake Bar S≈Çupsk">
          <span>MilkShake Bar</span>
        </a>
        <ul class="nav-menu">
          <li class="nav-item"><a href="#about" class="nav-link">O nas</a></li>
          <li class="nav-item"><a href="#menu" class="nav-link">Menu</a></li>
          <li class="nav-item"><a href="#loyalty" class="nav-link">Lojalno≈õƒá</a></li>
          <li class="nav-item"><a href="#location" class="nav-link">Lokal</a></li>
          <li class="nav-item"><a href="#reservation" class="nav-link">Rezerwacje</a></li>
        </ul>
        <a href="#reservation" class="btn btn-primary nav-btn">Rezerwacja <i class="fas fa-arrow-right"></i></a>
        <div class="hamburger">
          <i class="fas fa-bars fa-2x"></i>
        </div>
      </nav>
    </div>
  </header>

  <main>

    <section class="hero" id="home">
      <div class="container">
        <div class="hero-content">
          <div class="hero-text fade-in">
            <h1>Sztuka idealnego <span class="highlight">milkshake'a w S≈Çupsku</span></h1>
            <p>Zanurz siƒô w ≈õwiecie kremowej perfekcji. Tworzymy niezapomniane kompozycje, kt√≥re pobudzƒÖ Twoje zmys≈Çy i wywo≈ÇajƒÖ u≈õmiech.</p>
            <a href="#menu" class="btn btn-primary">Zobacz nasze menu <i class="fas fa-arrow-down"></i></a>
          </div>
          <div class="hero-image-container fade-in" style="transition-delay: 0.2s;">
            <img src="https://i.imgur.com/XIdoN0y.png" alt="MilkShake Bar S≈Çupsk - pyszny milkshake z bitƒÖ ≈õmietanƒÖ" class="hero-image" id="rotating-hero-image">
          </div>
        </div>
      </div>
    </section>

    <section id="about" class="section">
      <div class="container">
        <h2 class="section-title fade-in">Wiƒôcej ni≈º koktajl</h2>
        <div class="about-content">
          <div class="about-text fade-in">
            <h3>Nasza pasja do smaku.</h3>
            <p>MilkShake Bar w S≈Çupsku narodzi≈Ç siƒô z mi≈Ço≈õci do prostych przyjemno≈õci. Wierzymy, ≈ºe najlepsze smaki pochodzƒÖ z najlepszych sk≈Çadnik√≥w. Dlatego u≈ºywamy tylko ≈õwie≈ºych owoc√≥w, prawdziwych lod√≥w rzemie≈õlniczych i naturalnych dodatk√≥w.</p>
            <p>Nasza przestrze≈Ñ to nowoczesne, pe≈Çne energii miejsce, gdzie mo≈ºesz spotkaƒá siƒô ze znajomymi, zrelaksowaƒá i na≈Çadowaƒá baterie. Ka≈ºdy milkshake to dla nas ma≈Çe dzie≈Ço sztuki, przygotowane specjalnie dla Ciebie.</p>
          </div>
          <div class="about-image fade-in" style="transition-delay: 0.2s;">
            <img src="https://i.imgur.com/xppt7GP.jpeg" alt="Wnƒôtrze MilkShake Bar w S≈Çupsku">
          </div>
        </div>
      </div>
    </section>

    <section id="menu" class="section">
      <div class="container">
        <h2 class="section-title fade-in">Odkryj swoje ulubione</h2>
        <div class="see-more-button-container fade-in">
          <a href="menu.html" class="btn btn-primary">
            Zobacz pe≈Çne menu <i class="fas fa-arrow-right"></i>
          </a>
        </div>
      </div>
    </section>

    <section id="gallery" class="section">
      <div class="container">
        <h2 class="section-title fade-in">Chwytaj chwile, ≈Çap smaki</h2>
        <div class="gallery-grid fade-in">
          <div class="gallery-item"><img src="https://i.imgur.com/XIdoN0y.png" alt="Milkshake w szklance - MilkShake Bar S≈Çupsk"></div>
          <div class="gallery-item"><img src="https://i.imgur.com/kfE4j7j.jpeg" alt="Milkshake z Oreo - MilkShake Bar w S≈Çupsku"></div>
          <div class="gallery-item"><img src="https://i.imgur.com/dsMynF5.png" alt="Czekoladowy deser MilkShake Bar S≈Çupsk"></div>
          <div class="gallery-item"><img src="https://i.imgur.com/frz51UG.png" alt="Deser Brownie w MilkShake Bar S≈Çupsk"></div>
          <div class="gallery-item"><img src="https://i.imgur.com/GRvCj6z.png" alt="Pancakes w MilkShake Bar S≈Çupsk"></div>
          <div class="gallery-item"><img src="https://i.imgur.com/7Bx2X7g.png" alt="Owocowy milkshake MilkShake Bar S≈Çupsk"></div>
        </div>
      </div>
    </section>

    <section id="reservation" class="section">
      <div class="container">
        <h2 class="section-title fade-in">Zarezerwuj swoje idealne miejsce</h2>

        <div class="reservation-wrapper grid-two-col fade-in" id="reservation-wrapper">
          <div class="form-container">
            <h3>Wype≈Çnij swoje dane</h3>

            <form id="bookingForm" class="booking-form" aria-label="Formularz rezerwacji">
              <div class="form-row">
                <div class="form-group">
                  <label for="name">Imiƒô i nazwisko</label>
                  <input id="name" name="name" type="text" placeholder="Jan Kowalski" required>
                </div>
                <div class="form-group">
                  <label for="phone">Telefon</label>
                  <input id="phone" name="phone" type="tel" placeholder="+48 700 000 000" required>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="date">Data</label>
                  <input id="date" name="date" type="date" required>
                </div>
                <div class="form-group">
                  <label for="time">Godzina</label>
                  <input id="time" name="time" type="time" required>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group">
                  <label for="guests">Ilo≈õƒá os√≥b</label>
                  <select id="guests" name="guests" required>
                    <option value="1">1 osoba</option>
                    <option value="2" selected>2 osoby</option>
                    <option value="3">3 osoby</option>
                    <option value="4">4 osoby</option>
                    <option value="5">5+ os√≥b</option>
                  </select>
                </div>

                <div class="form-group">
                  <label>Strefa</label>
                  <div class="room-options" role="radiogroup" aria-label="Wybierz strefƒô">
                    <label class="room-label"><input type="radio" name="room" value="Sala frontowa" required> Sala frontowa</label>
                    <label class="room-label"><input type="radio" name="room" value="Sala g≈Ç√≥wna"> Sala g≈Ç√≥wna</label>
                    <label class="room-label"><input type="radio" name="room" value="KƒÖcik dla dzieci"> KƒÖcik dla dzieci</label>
                  </div>
                </div>
              </div>

              <div class="form-row">
                <div class="form-group fullwidth">
                  <label for="notes">Dodatkowe informacje (opcjonalnie)</label>
                  <input id="notes" name="notes" type="text" placeholder="np. urodziny, alergie">
                </div>
              </div>

              <div class="form-row">
                <button type="submit" class="btn btn-primary booking-submit">Zarezerwuj teraz <i class="fas fa-check"></i></button>
              </div>
            </form>
          </div>

          <aside class="reservation-summary" aria-live="polite">
            <h3>Twoja rezerwacja</h3>
            <div class="summary-card">
              <p><strong>Imiƒô:</strong> <span id="summary-name">‚Äî</span></p>
              <p><strong>Telefon:</strong> <span id="summary-phone">‚Äî</span></p>
              <p><strong>Data:</strong> <span id="summary-date">‚Äî</span></p>
              <p><strong>Godzina:</strong> <span id="summary-time">‚Äî</span></p>
              <p><strong>Ilo≈õƒá os√≥b:</strong> <span id="summary-guests">‚Äî</span></p>
              <p><strong>Strefa:</strong> <span id="summary-room">‚Äî</span></p>
              <p><strong>Uwagi:</strong> <span id="summary-notes">‚Äî</span></p>
            </div>

            <div class="map-mini">
              <img src="https://i.imgur.com/xppt7GP.jpeg" alt="Wnƒôtrze lokalu MilkShake Bar w S≈Çupsku" style="width:100%; border-radius:12px;">
            </div>
          </aside>
        </div>
      </div>
    </section>

    <!-- PROGRAM LOJALNO≈öCIOWY -->
    <section id="loyalty" class="section">
      <div class="container">
        <h2 class="section-title fade-in">Program lojalno≈õciowy</h2>

        <div class="reservation-wrapper grid-two-col fade-in" style="align-items: stretch;">
          <div class="form-container">
            <h3>Zbieraj punkty i odbieraj nagrody üéÅ</h3>
            <p style="line-height:1.8; margin-bottom:14px;">
              Aby zaczƒÖƒá zbieraƒá punkty, dodaj MilkShake Bar do ekranu g≈Ç√≥wnego telefonu
              (zainstaluj jako aplikacjƒô PWA). Dopiero wtedy odblokujemy punkty i nagrody.
            </p>

            <div id="pwa-install-box" style="
              background:#fff; border:2px dashed #ffd1a6; padding:14px; border-radius:14px;
              display:flex; flex-direction:column; gap:10px; margin-top:12px;">
              <strong id="pwa-status-text">Sprawdzam, czy aplikacja jest zainstalowana‚Ä¶</strong>

              <button id="installPWAButton" class="btn btn-primary" style="display:none; width:max-content;">
                Zainstaluj aplikacjƒô <i class="fas fa-download"></i>
              </button>

              <div id="manual-install-hint" style="display:none; font-size:0.95rem; opacity:0.9;">
                Je≈õli nie widzisz przycisku, otw√≥rz menu przeglƒÖdarki i wybierz:
                <b>‚ÄûDodaj do ekranu g≈Ç√≥wnego‚Äù</b>.
              </div>
            </div>

            <div style="margin-top:18px; font-size:0.95rem; opacity:0.85;">
              <p><b>Jak zdobywasz punkty?</b></p>
              <ul style="margin:8px 0 0 18px; line-height:1.7;">
                <li>Po zakupie dostajesz kod od obs≈Çugi / z paragonu.</li>
                <li>Wpisujesz kod w aplikacji i punkty wpadajƒÖ na konto.</li>
                <li>Wymieniasz punkty na nagrody w tym panelu.</li>
              </ul>
            </div>
          </div>

          <aside class="reservation-summary" aria-live="polite">
            <h3>Twoje punkty</h3>

            <div id="loyalty-locked" class="summary-card" style="display:none;">
              <p style="margin:0;">
                üîí <b>Panel jest zablokowany</b><br>
                Zainstaluj aplikacjƒô PWA, aby zaczƒÖƒá zbieraƒá punkty.
              </p>
            </div>

            <div id="loyalty-unlocked" style="display:none;">
              <div class="summary-card">
                <p><strong>Stan punkt√≥w:</strong> <span id="points-balance">0</span> pkt</p>
                <p style="font-size:0.9rem; opacity:0.8;">Punkty zapisujƒÖ siƒô w Twojej aplikacji.</p>
              </div>

              <div class="summary-card">
                <p><strong>Dodaj punkty z kodu:</strong></p>
                <div style="display:flex; gap:8px; margin-top:8px;">
                  <input id="loyalty-code-input" type="text"
                         placeholder="Wpisz kod (np. MSB-10)"
                         style="flex:1; padding:10px 12px; border-radius:10px; border:2px solid #eee;">
                  <button id="redeem-code-btn" class="btn btn-primary" style="padding:10px 14px;">
                    Dodaj
                  </button>
                </div>
                <p id="code-result" style="margin-top:8px; font-size:0.95rem;"></p>
              </div>

              <div class="summary-card">
                <p><strong>Nagrody:</strong></p>
                <div id="rewards-list" style="display:grid; gap:10px; margin-top:10px;"></div>
              </div>
            </div>
          </aside>
        </div>
      </div>
    </section>

    <section id="location" class="section">
      <div class="container fade-in">
        <div class="location-contact-grid">

          <div class="location-details">
            <h3>Jeste≈õmy tutaj</h3>

            <div class="info-item">
              <i class="fas fa-map-marker-alt"></i>
              <span id="addressText">Szczeci≈Ñska 17<br>76-200 S≈Çupsk</span>
            </div>

            <div class="info-item">
              <i class="fas fa-location-dot"></i>
              <span>Wydmowa 2<br>76-212 Rowy</span>
            </div>

            <div class="info-item">
              <i class="fas fa-clock"></i>
              <span><b>Godziny otwarcia:</b><br>Pon-Sob: 12:00 - 22:00<br>Ndz: 12:00 - 21:00</span>
            </div>

            <div class="info-item">
              <i class="fas fa-phone"></i>
              <span>+48 733 033 100</span>
            </div>
          </div>

          <div class="map-container" id="mapContainer">
            <button class="map-arrow left" type="button" aria-label="Poprzednia lokalizacja">
              <i class="fas fa-chevron-left"></i>
            </button>

            <iframe
              id="mapFrame"
              src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2331.002829241513!2d17.01509831582845!3d54.46736898022934!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x46fe1e12a4d3148d%3A0xe5a1b37937a6b5a3!2sSzczeci%C5%84ska%2017%2C%2076-200%20S%C5%82upsk!5e0!3m2!1spl!2spl!4v1694080000000"
              allowfullscreen=""
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              title="Mapa dojazdu do MilkShake Bar"
            ></iframe>

            <button class="map-arrow right" type="button" aria-label="Nastƒôpna lokalizacja">
              <i class="fas fa-chevron-right"></i>
            </button>

            <div class="map-badge" id="mapBadge">S≈Çupsk</div>
          </div>

        </div>
      </div>
    </section>

  </main>

  <footer class="footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-col">
          <a href="#home" class="logo">
            <img src="https://i.imgur.com/Twr2Rms.jpeg" alt="Logo MilkShake Bar S≈Çupsk">
            <span>MilkShake Bar</span>
          </a>
          <p>Zanurz siƒô w ≈õwiecie kremowej perfekcji, gdzie ka≈ºdy koktajl to dzie≈Ço sztuki.</p>
        </div>
        <div class="footer-col">
          <h4>Nawigacja</h4>
          <ul>
            <li><a href="#about">O nas</a></li>
            <li><a href="#menu">Menu MilkShake Bar S≈Çupsk</a></li>
            <li><a href="#gallery">Galeria</a></li>
            <li><a href="#reservation">Rezerwacja</a></li>
            <li><a href="#loyalty">Program lojalno≈õciowy</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Kontakt</h4>
          <ul>
            <li><i class="fas fa-map-marker-alt"></i> Szczeci≈Ñska 17, 76-200 S≈Çupsk, Wydmowa 2, 76-212 Rowy</li>
            <li><i class="fas fa-phone"></i> +48 733 033 100</li>
            <li><i class="fas fa-clock"></i> Otwarte: Pn-Pt 8-22, Sb-Nd 10-22</li>
          </ul>
        </div>
        <div class="footer-col">
          <h4>Znajd≈∫ nas</h4>
          <div class="footer-socials">
            <a href="https://www.facebook.com/milkshakebar" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
            <a href="https://www.instagram.com/milkshake_slupsk" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>¬© 2025 MilkShake Bar. Wszystkie prawa zastrze≈ºone.</p>
      </div>
    </div>
  </footer>

  <div id="reservation-toast" class="reservation-toast" aria-live="polite">
    <i class="fas fa-check-circle"></i>
    <span id="reservation-toast-text">Rezerwacja zosta≈Ça z≈Ço≈ºona.</span>
  </div>

  <script>
    document.addEventListener("DOMContentLoaded", function(){

      // HERO random image
      var heroImage = document.getElementById("rotating-hero-image");
      if(heroImage){
        var images = [
          "https://i.imgur.com/dwsQzpr.png",
          "https://i.imgur.com/AJ95p9Q.png",
          "https://i.imgur.com/AlIo5bU.png",
          "https://i.imgur.com/T4tHYPu.png",
          "https://i.imgur.com/MmRVhiR.png"
        ];
        heroImage.src = images[Math.floor(Math.random()*images.length)];
      }

      // Header scroll
      var header = document.getElementById("header");
      window.addEventListener("scroll", function(){
        if(header) header.classList.toggle("scrolled", window.scrollY > 50);
      });

      // Mobile menu
      var hamburger = document.querySelector(".hamburger");
      var navMenu = document.querySelector(".nav-menu");
      var navLinks = document.querySelectorAll(".nav-link");

      function toggleMenu(){ if(navMenu) navMenu.classList.toggle("active"); }
      function closeMenu(){ if(navMenu) navMenu.classList.remove("active"); }

      if(hamburger) hamburger.addEventListener("click", toggleMenu);
      navLinks.forEach(function(link){
        link.addEventListener("click", closeMenu);
      });

      // Fade-in observer
      var observer = new IntersectionObserver(function(entries){
        entries.forEach(function(entry){
          if(entry.isIntersecting){
            entry.target.classList.add("visible");
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.1 });

      document.querySelectorAll(".fade-in").forEach(function(el){
        observer.observe(el);
      });

      // Active nav link
      var sections = document.querySelectorAll("section[id]");
      function updateActiveLink(){
        var currentSection = "";
        sections.forEach(function(section){
          var sectionTop = section.offsetTop;
          if(pageYOffset >= sectionTop - 150){
            currentSection = section.getAttribute("id");
          }
        });

        navLinks.forEach(function(link){
          link.classList.remove("active");
          if(link.getAttribute("href").indexOf(currentSection) !== -1){
            link.classList.add("active");
          }
        });
      }
      window.addEventListener("scroll", updateActiveLink);
      updateActiveLink();

      // Reservation toast
      var reservationToast = document.getElementById("reservation-toast");
      var reservationToastText = document.getElementById("reservation-toast-text");

      function showReservationToast(message, isError){
        if(!reservationToast || !reservationToastText) return;
        reservationToastText.textContent = message;
        reservationToast.style.background = isError
          ? getComputedStyle(document.documentElement).getPropertyValue("--error-color")
          : getComputedStyle(document.documentElement).getPropertyValue("--success-color");

        reservationToast.classList.add("visible");
        setTimeout(function(){
          reservationToast.classList.remove("visible");
        }, 4000);
      }

      // Reservation form + summary
      (function(){
        var bookingForm = document.getElementById("bookingForm");
        if(!bookingForm) return;

        var inputs = {
          name: document.getElementById("name"),
          phone: document.getElementById("phone"),
          date: document.getElementById("date"),
          time: document.getElementById("time"),
          guests: document.getElementById("guests"),
          notes: document.getElementById("notes"),
          roomRadios: bookingForm.querySelectorAll('input[name="room"]')
        };

        var summary = {
          name: document.getElementById("summary-name"),
          phone: document.getElementById("summary-phone"),
          date: document.getElementById("summary-date"),
          time: document.getElementById("summary-time"),
          guests: document.getElementById("summary-guests"),
          room: document.getElementById("summary-room"),
          notes: document.getElementById("summary-notes")
        };

        if(inputs.date){
          var today = new Date().toISOString().split("T")[0];
          inputs.date.setAttribute("min", today);
        }

        function updateSummary(){
          summary.name.textContent = inputs.name.value || "‚Äî";
          summary.phone.textContent = inputs.phone.value || "‚Äî";
          summary.date.textContent = inputs.date.value || "‚Äî";
          summary.time.textContent = inputs.time.value || "‚Äî";
          summary.guests.textContent = inputs.guests.value || "‚Äî";
          summary.notes.textContent = inputs.notes.value || "‚Äî";
          var selectedRoom = Array.from(inputs.roomRadios).find(function(r){ return r.checked; });
          summary.room.textContent = selectedRoom ? selectedRoom.value : "‚Äî";
        }

        function attach(el){
          if(!el) return;
          if(NodeList.prototype.isPrototypeOf(el)){
            el.forEach(function(item){
              item.addEventListener("change", updateSummary);
              item.addEventListener("input", updateSummary);
            });
          }else{
            el.addEventListener("change", updateSummary);
            el.addEventListener("input", updateSummary);
          }
        }

        Object.values(inputs).forEach(attach);
        updateSummary();

        bookingForm.addEventListener("submit", async function(e){
          e.preventDefault();
          var submitButton = bookingForm.querySelector('button[type="submit"]');
          var originalText = submitButton.innerHTML;
          submitButton.disabled = true;
          submitButton.innerHTML = "Wysy≈Çanie...";

          var formData = new FormData(bookingForm);
          var data = Object.fromEntries(formData.entries());

          try{
            var response = await fetch("/api/rezerwacje", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(data)
            });

            if(!response.ok){
              var errorData = await response.json().catch(function(){ return {}; });
              throw new Error(errorData.message || "WystƒÖpi≈Ç b≈ÇƒÖd serwera.");
            }

            showReservationToast("Dziƒôkujemy! Twoja rezerwacja zosta≈Ça z≈Ço≈ºona. üß°");
            bookingForm.reset();
            updateSummary();

          }catch(err){
            console.error(err);
            showReservationToast("B≈ÇƒÖd: " + err.message, true);
          }finally{
            submitButton.disabled = false;
            submitButton.innerHTML = originalText;
          }
        });

      })();

      // Happy bar load
      (async function(){
        var bar = document.getElementById("happyBar");
        var textEl = document.getElementById("happyBarText");
        if(!bar || !textEl) return;

        try{
          var res = await fetch("/api/data", { cache: "no-store" });
          if(!res.ok) throw new Error(res.status);
          var db = await res.json();
          var happy = (db.happy || "").trim();

          if(happy){
            textEl.textContent = happy;
            bar.style.display = "block";
            document.body.classList.add("has-happybar");
          }else{
            bar.style.display = "none";
            document.body.classList.remove("has-happybar");
          }
        }catch(e){
          console.error("Happy bar load failed", e);
        }
      })();

      // Map switch
      (function(){
        var frame = document.getElementById("mapFrame");
        var badge = document.getElementById("mapBadge");
        var addressText = document.getElementById("addressText");
        var container = document.getElementById("mapContainer");
        if(!frame || !badge || !container) return;

        var leftBtn = container.querySelector(".map-arrow.left");
        var rightBtn = container.querySelector(".map-arrow.right");

        var locations = [
          {
            name: "S≈Çupsk",
            addressHTML: "Szczeci≈Ñska 17<br>76-200 S≈Çupsk",
            src: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2331.002829241513!2d17.01509831582845!3d54.46736898022934!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x46fe1e12a4d3148d%3A0xe5a1b37937a6b5a3!2sSzczeci%C5%84ska%2017%2C%2076-200%20S%C5%82upsk!5e0!3m2!1spl!2spl!4v1694080000000"
          },
          {
            name: "Rowy",
            addressHTML: "Wydmowa 2<br>76-212 Rowy",
            src: "https://www.google.com/maps?q=Wydmowa+2,+76-212+Rowy&output=embed"
          }
        ];

        var idx = 0;
        function render(){
          var loc = locations[idx];
          frame.src = loc.src;
          badge.textContent = loc.name;
          if(addressText) addressText.innerHTML = loc.addressHTML;
        }
        function next(){ idx = (idx + 1) % locations.length; render(); }
        function prev(){ idx = (idx - 1 + locations.length) % locations.length; render(); }

        if(rightBtn) rightBtn.addEventListener("click", next);
        if(leftBtn) leftBtn.addEventListener("click", prev);

        render();
      })();

      // ---------------- LOYALTY PWA-FIRST (bez backtick√≥w) ----------------
      (function(){
        var installBtn = document.getElementById("installPWAButton");
        var manualHint = document.getElementById("manual-install-hint");
        var statusText = document.getElementById("pwa-status-text");

        var lockedBox = document.getElementById("loyalty-locked");
        var unlockedBox = document.getElementById("loyalty-unlocked");
        var pointsEl = document.getElementById("points-balance");
        var codeInput = document.getElementById("loyalty-code-input");
        var redeemBtn = document.getElementById("redeem-code-btn");
        var codeResult = document.getElementById("code-result");
        var rewardsList = document.getElementById("rewards-list");
        if(!lockedBox || !unlockedBox) return;

        var deferredPrompt = null;

        function isStandalone(){
          return window.matchMedia("(display-mode: standalone)").matches
            || window.navigator.standalone === true;
        }

        function setUI(installed){
          if(installed){
            if(statusText) statusText.textContent = "‚úÖ Aplikacja zainstalowana ‚Äî mo≈ºesz zbieraƒá punkty!";
            if(installBtn) installBtn.style.display = "none";
            if(manualHint) manualHint.style.display = "none";
            lockedBox.style.display = "none";
            unlockedBox.style.display = "block";
            renderPoints();
            renderRewards();
          }else{
            if(statusText) statusText.textContent = "üîî Zainstaluj aplikacjƒô, aby odblokowaƒá punkty.";
            lockedBox.style.display = "block";
            unlockedBox.style.display = "none";

            if(deferredPrompt){
              if(installBtn) installBtn.style.display = "inline-flex";
              if(manualHint) manualHint.style.display = "none";
            }else{
              if(installBtn) installBtn.style.display = "none";
              if(manualHint) manualHint.style.display = "block";
            }
          }
        }

        window.addEventListener("beforeinstallprompt", function(e){
          e.preventDefault();
          deferredPrompt = e;
          setUI(isStandalone());
        });

        window.addEventListener("appinstalled", function(){
          deferredPrompt = null;
          setUI(true);
        });

        if(installBtn){
          installBtn.addEventListener("click", async function(){
            if(!deferredPrompt) return;
            deferredPrompt.prompt();
            await deferredPrompt.userChoice.catch(function(){});
            deferredPrompt = null;
            setUI(isStandalone());
          });
        }

        setUI(isStandalone());

        var STORAGE_KEY = "msb_loyalty_points_v1";
        var USED_CODES_KEY = "msb_loyalty_used_codes_v1";

        function getPoints(){ return Number(localStorage.getItem(STORAGE_KEY) || 0); }
        function setPoints(v){
          localStorage.setItem(STORAGE_KEY, String(v));
          renderPoints(); renderRewards();
        }
        function getUsedCodes(){
          try{ return JSON.parse(localStorage.getItem(USED_CODES_KEY) || "[]"); }
          catch(e){ return []; }
        }
        function addUsedCode(code){
          var arr = getUsedCodes(); arr.push(code);
          localStorage.setItem(USED_CODES_KEY, JSON.stringify(arr));
        }

        function renderPoints(){
          if(pointsEl) pointsEl.textContent = getPoints();
        }

        var CODES = { "MSB-10":10, "MSB-20":20, "MSB-30":30 };
        if(redeemBtn){
          redeemBtn.addEventListener("click", function(){
            if(!isStandalone()){ setUI(false); return; }
            var code = (codeInput.value || "").trim().toUpperCase();
            if(!code){
              codeResult.textContent = "Wpisz kod.";
              codeResult.style.color = "var(--error-color)";
              return;
            }
            var used = getUsedCodes();
            if(used.includes(code)){
              codeResult.textContent = "Ten kod by≈Ç ju≈º u≈ºyty.";
              codeResult.style.color = "var(--error-color)";
              return;
            }
            var pts = CODES[code];
            if(!pts){
              codeResult.textContent = "Nieprawid≈Çowy kod.";
              codeResult.style.color = "var(--error-color)";
              return;
            }
            addUsedCode(code);
            setPoints(getPoints() + pts);
            codeResult.textContent = "Dodano " + pts + " pkt ‚úÖ";
            codeResult.style.color = "var(--success-color)";
            codeInput.value = "";
          });
        }

        var REWARDS = [
          { id:"shake_small", name:"Milkshake 300ml -50%", cost:60 },
          { id:"coffee_free", name:"Kawa gratis", cost:80 },
          { id:"dessert_free", name:"Deser gratis", cost:120 },
          { id:"shake_big", name:"Milkshake 500ml gratis", cost:160 }
        ];

        function renderRewards(){
          if(!rewardsList) return;
          var balance = getPoints();
          rewardsList.innerHTML = "";

          REWARDS.forEach(function(r){
            var canBuy = balance >= r.cost;
            var item = document.createElement("div");
            item.className = "reward-item";

            item.innerHTML =
              '<div>' +
                '<div style="font-weight:700;">' + r.name + '</div>' +
                '<small>Koszt: ' + r.cost + ' pkt</small>' +
              '</div>' +
              '<button class="btn btn-primary" ' + (canBuy ? "" : "disabled") + '>' +
                (canBuy ? "Odbierz" : "Brak punkt√≥w") +
              '</button>';

            var btn = item.querySelector("button");
            btn.addEventListener("click", function(){
              if(!canBuy) return;
              var ok = confirm("Odebraƒá nagrodƒô: " + r.name + " za " + r.cost + " pkt?");
              if(!ok) return;
              setPoints(balance - r.cost);
              alert("‚úÖ Nagroda aktywowana! Poka≈º ten komunikat obs≈Çudze przy kasie.");
            });

            rewardsList.appendChild(item);
          });
        }

      })();

    });
  </script>

  <!-- socket.io realtime happybar -->
  <script src="/socket.io/socket.io.js"></script>
  <script>
    try {
      var socket = io();
      socket.on("happy-updated", function(text){
        var bar = document.getElementById("happyBar");
        var textEl = document.getElementById("happyBarText");
        if(!bar || !textEl) return;

        var happy = (text || "").trim();
        if(happy){
          textEl.textContent = happy;
          bar.style.display = "block";
          document.body.classList.add("has-happybar");
        }else{
          bar.style.display = "none";
          document.body.classList.remove("has-happybar");
        }
      });
    } catch(e){}
  </script>

  <!-- SW register -->
  <script>
    if("serviceWorker" in navigator){
      navigator.serviceWorker.register("/sw.js").catch(function(){});
    }
  </script>
</body>
</html>
